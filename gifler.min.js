/** gifler.js | github.com/themadcreator/gifler | @license: Apache-2.0 */
!function t(e,r,n){function i(o,s){if(!r[o]){if(!e[o]){var h="function"==typeof require&&require;if(!s&&h)return h(o,!0);if(a)return a(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var u=r[o]={exports:{}};e[o][0].call(u.exports,function(t){var r=e[o][1][t];return i(r?r:t)},u,u.exports,t,e,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,e,r){var n,i,a,o,s,h,f,u,l=function(t,e){return function(){return t.apply(e,arguments)}};a=t("omggif").GifReader,f=function(t){var e,r;return r=new XMLHttpRequest,r.open("GET",t,e=!0),r.responseType="arraybuffer",new i(r)},i=function(){function t(t){this.xhr=t}return t.prototype.animate=function(t){var e;return e=h(t),this.xhr.onload=u(function(t){return t.animateInCanvas(e)}),this.xhr.send(),this},t.prototype.frames=function(t,e,r){var n;return null==r&&(r=!1),n=h(t),this.xhr.onload=u(function(t){return t.onDrawFrame=e,t.animateInCanvas(n,r)}),this.xhr.send(),this},t.prototype.get=function(t){return this.xhr.onload=u(t),this.xhr.send(),this},t}(),u=function(t){return function(e){return t(new n(new a(new Uint8Array(this.response))))}},h=function(t){var e,r;if("string"==typeof t&&"CANVAS"===(null!=(r=e=document.querySelector(t))?r.tagName:void 0))return e;if("CANVAS"===(null!=t?t.tagName:void 0))return t;throw new Error("Unexpected selector type. Valid types are query-selector-string/canvas-element")},o=function(t,e,r){var n,i,a;return n=document.createElement("canvas"),i=n.getContext("2d"),n.width=t.width,n.height=t.height,a=i.createImageData(e,r),a.data.set(t.pixels),i.putImageData(a,-t.x,-t.y),n},s=function(t,e){var r;return function(){r=[];for(var e=0,n=t.numFrames();n>=0?n>e:e>n;n>=0?e++:e--)r.push(e);return r}.apply(this).map(function(e){return function(e){var r;return r=t.frameInfo(e),r.pixels=new Uint8ClampedArray(t.width*t.height*4),t.decodeAndBlitFrameRGBA(e,r.pixels),r}}(this))},n=function(){function t(t){var e;this._reader=t,this._advanceFrame=l(this._advanceFrame,this),this._nextFrameRender=l(this._nextFrameRender,this),this._nextFrame=l(this._nextFrame,this),e=this._reader,this.width=e.width,this.height=e.height,this._frames=s(this._reader),this._loopCount=this._reader.loopCount(),this._loops=0,this._frameIndex=0,this._running=!1}return t.prototype.start=function(){return this._lastTime=(new Date).valueOf(),this._delayCompensation=0,this._running=!0,setTimeout(this._nextFrame,0),this},t.prototype.stop=function(){return this._running=!1,this},t.prototype.reset=function(){return this._frameIndex=0,this._loops=0,this},t.prototype._nextFrame=function(){requestAnimationFrame(this._nextFrameRender)},t.prototype._nextFrameRender=function(){var t,e;if(this._running)return t=this._frames[this._frameIndex],null!=(e=this.onFrame)&&e.apply(this,[t,this._frameIndex]),this._enqueueNextFrame()},t.prototype._advanceFrame=function(){this._frameIndex+=1,this._frameIndex>=this._frames.length&&(0!==this._loopCount&&this._loopCount===this._loops?this.stop():(this._frameIndex=0,this._loops+=1))},t.prototype._enqueueNextFrame=function(){var t,e,r,n;for(this._advanceFrame();this._running;){if(r=this._frames[this._frameIndex],e=(new Date).valueOf()-this._lastTime,this._lastTime+=e,this._delayCompensation+=e,n=10*r.delay,t=n-this._delayCompensation,this._delayCompensation-=n,!(0>t)){setTimeout(this._nextFrame,t);break}this._advanceFrame()}},t.prototype.animateInCanvas=function(t,e){var r;return null==e&&(e=!0),e&&(t.width=this.width,t.height=this.height),r=t.getContext("2d"),null==this.onDrawFrame&&(this.onDrawFrame=function(t,e,r){return t.drawImage(e.buffer,e.x,e.y)}),null==this.onFrame&&(this.onFrame=function(e){return function(n,i){var a,s;switch(null==n.buffer&&(n.buffer=o(n,e.width,e.height)),"function"==typeof e.disposeFrame&&e.disposeFrame(),n.disposal){case 2:e.disposeFrame=function(){return r.clearRect(0,0,t.width,t.height)};break;case 3:s=r.getImageData(0,0,t.width,t.height),e.disposeFrame=function(){return r.putImageData(s,0,0)};break;default:e.disposeFrame=null}return null!=(a=e.onDrawFrame)?a.apply(e,[r,n,i]):void 0}}(this)),this.start(),this},t}(),f.Animator=n,f.decodeFrames=s,f.createBufferCanvas=o,"undefined"!=typeof window&&null!==window&&(window.gifler=f),"undefined"!=typeof e&&null!==e&&(e.exports=f)},{omggif:2}],2:[function(t,e,r){function n(t,e,r,n){function a(t){var e=t.length;if(2>e||e>256||e&e-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return e}var o=0,n=void 0===n?{}:n,s=void 0===n.loop?null:n.loop,h=void 0===n.palette?null:n.palette;if(0>=e||0>=r||e>65535||r>65535)throw"Width/Height invalid.";t[o++]=71,t[o++]=73,t[o++]=70,t[o++]=56,t[o++]=57,t[o++]=97;var f=0,u=0;if(null!==h){for(var l=a(h);l>>=1;)++f;if(l=1<<f,--f,void 0!==n.background){if(u=n.background,u>=l)throw"Background index out of range.";if(0===u)throw"Background index explicitly passed as 0."}}if(t[o++]=255&e,t[o++]=e>>8&255,t[o++]=255&r,t[o++]=r>>8&255,t[o++]=(null!==h?128:0)|f,t[o++]=u,t[o++]=0,null!==h)for(var d=0,c=h.length;c>d;++d){var p=h[d];t[o++]=p>>16&255,t[o++]=p>>8&255,t[o++]=255&p}if(null!==s){if(0>s||s>65535)throw"Loop count invalid.";t[o++]=33,t[o++]=255,t[o++]=11,t[o++]=78,t[o++]=69,t[o++]=84,t[o++]=83,t[o++]=67,t[o++]=65,t[o++]=80,t[o++]=69,t[o++]=50,t[o++]=46,t[o++]=48,t[o++]=3,t[o++]=1,t[o++]=255&s,t[o++]=s>>8&255,t[o++]=0}var v=!1;this.addFrame=function(e,r,n,s,f,u){if(v===!0&&(--o,v=!1),u=void 0===u?{}:u,0>e||0>r||e>65535||r>65535)throw"x/y invalid.";if(0>=n||0>=s||n>65535||s>65535)throw"Width/Height invalid.";if(f.length<n*s)throw"Not enough pixels for the frame size.";var l=!0,d=u.palette;if((void 0===d||null===d)&&(l=!1,d=h),void 0===d||null===d)throw"Must supply either a local or global palette.";for(var c=a(d),p=0;c>>=1;)++p;c=1<<p;var m=void 0===u.delay?0:u.delay,g=void 0===u.disposal?0:u.disposal;if(0>g||g>3)throw"Disposal out of range.";var _=!1,w=0;if(void 0!==u.transparent&&null!==u.transparent&&(_=!0,w=u.transparent,0>w||w>=c))throw"Transparent color index.";if((0!==g||_||0!==m)&&(t[o++]=33,t[o++]=249,t[o++]=4,t[o++]=g<<2|(_===!0?1:0),t[o++]=255&m,t[o++]=m>>8&255,t[o++]=w,t[o++]=0),t[o++]=44,t[o++]=255&e,t[o++]=e>>8&255,t[o++]=255&r,t[o++]=r>>8&255,t[o++]=255&n,t[o++]=n>>8&255,t[o++]=255&s,t[o++]=s>>8&255,t[o++]=l===!0?128|p-1:0,l===!0)for(var x=0,y=d.length;y>x;++x){var F=d[x];t[o++]=F>>16&255,t[o++]=F>>8&255,t[o++]=255&F}o=i(t,o,2>p?2:p,f)},this.end=function(){return v===!1&&(t[o++]=59,v=!0),o}}function i(t,e,r,n){function i(r){for(;d>=r;)t[e++]=255&c,c>>=8,d-=8,e===o+256&&(t[o]=255,o=e++)}function a(t){c|=t<<d,d+=l,i(8)}t[e++]=r;var o=e++,s=1<<r,h=s-1,f=s+1,u=f+1,l=r+1,d=0,c=0,p=n[0]&h,v={};a(s);for(var m=1,g=n.length;g>m;++m){var _=n[m]&h,w=p<<8|_,x=v[w];if(void 0===x){for(c|=p<<d,d+=l;d>=8;)t[e++]=255&c,c>>=8,d-=8,e===o+256&&(t[o]=255,o=e++);4096===u?(a(s),u=f+1,l=r+1,v={}):(u>=1<<l&&++l,v[w]=u++),p=_}else p=x}return a(p),a(f),i(1),o+1===e?t[o]=0:(t[o]=e-o-1,t[e++]=0),e}function a(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!==(t[e++]+1&253)||97!==t[e++])throw"Invalid GIF 87a/89a header.";var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,s=7&i,h=1<<s+1;t[e++];t[e++];var f=null;a&&(f=e,e+=3*h);var u=!0,l=[],d=0,c=null,p=0,v=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,v=t[e++]|t[e++]<<8,e++;else for(e+=12;;){var m=t[e++];if(0===m)break;e+=m}break;case 249:if(4!==t[e++]||0!==t[e+4])throw"Invalid graphics extension block.";var g=t[e++];d=t[e++]|t[e++]<<8,c=t[e++],0===(1&g)&&(c=null),p=g>>2&7,e++;break;case 254:for(;;){var m=t[e++];if(0===m)break;e+=m}break;default:throw"Unknown graphic control label: 0x"+t[e-1].toString(16)}break;case 44:var _=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,F=t[e++],b=F>>7,I=F>>6&1,k=7&F,C=1<<k+1,A=f,D=!1;if(b){var D=!0;A=e,e+=3*C}var R=e;for(e++;;){var m=t[e++];if(0===m)break;e+=m}l.push({x:_,y:w,width:x,height:y,has_local_palette:D,palette_offset:A,data_offset:R,data_length:e-R,transparent_index:c,interlaced:!!I,delay:d,disposal:p});break;case 59:u=!1;break;default:throw"Unknown gif block: 0x"+t[e-1].toString(16)}this.numFrames=function(){return l.length},this.loopCount=function(){return v},this.frameInfo=function(t){if(0>t||t>=l.length)throw"Frame index out of range.";return l[t]},this.decodeAndBlitFrameBGRA=function(e,n){var i=this.frameInfo(e),a=i.width*i.height,s=new Uint8Array(a);o(t,i.data_offset,s,a);var h=i.palette_offset,f=i.transparent_index;null===f&&(f=256);var u=i.width,l=r-u,d=u,c=4*(i.y*r+i.x),p=4*((i.y+i.height)*r+i.x),v=c,m=4*l;i.interlaced===!0&&(m+=4*r*7);for(var g=8,_=0,w=s.length;w>_;++_){var x=s[_];if(0===d&&(v+=m,d=u,v>=p&&(m=4*l+4*r*(g-1),v=c+(u+l)*(g<<1),g>>=1)),x===f)v+=4;else{var y=t[h+3*x],F=t[h+3*x+1],b=t[h+3*x+2];n[v++]=b,n[v++]=F,n[v++]=y,n[v++]=255}--d}},this.decodeAndBlitFrameRGBA=function(e,n){var i=this.frameInfo(e),a=i.width*i.height,s=new Uint8Array(a);o(t,i.data_offset,s,a);var h=i.palette_offset,f=i.transparent_index;null===f&&(f=256);var u=i.width,l=r-u,d=u,c=4*(i.y*r+i.x),p=4*((i.y+i.height)*r+i.x),v=c,m=4*l;i.interlaced===!0&&(m+=4*r*7);for(var g=8,_=0,w=s.length;w>_;++_){var x=s[_];if(0===d&&(v+=m,d=u,v>=p&&(m=4*l+4*r*(g-1),v=c+(u+l)*(g<<1),g>>=1)),x===f)v+=4;else{var y=t[h+3*x],F=t[h+3*x+1],b=t[h+3*x+2];n[v++]=y,n[v++]=F,n[v++]=b,n[v++]=255}--d}}}function o(t,e,r,n){for(var i=t[e++],a=1<<i,o=a+1,s=o+1,h=i+1,f=(1<<h)-1,u=0,l=0,d=0,c=t[e++],p=new Int32Array(4096),v=null;;){for(;16>u&&0!==c;)l|=t[e++]<<u,u+=8,1===c?c=t[e++]:--c;if(h>u)break;var m=l&f;if(l>>=h,u-=h,m!==a){if(m===o)break;for(var g=s>m?m:v,_=0,w=g;w>a;)w=p[w]>>8,++_;var x=w,y=d+_+(g!==m?1:0);if(y>n)return void console.log("Warning, gif stream longer than expected.");r[d++]=x,d+=_;var F=d;for(g!==m&&(r[d++]=x),w=g;_--;)w=p[w],r[--F]=255&w,w>>=8;null!==v&&4096>s&&(p[s++]=v<<8|x,s>=f+1&&12>h&&(++h,f=f<<1|1)),v=m}else s=o+1,h=i+1,f=(1<<h)-1,v=null}return d!==n&&console.log("Warning, gif stream shorter than expected."),r}try{r.GifWriter=n,r.GifReader=a}catch(t){}},{}]},{},[1]);
